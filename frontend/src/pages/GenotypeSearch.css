/* GenotypeSearch.css */

/* --- Base & Theming --- */
body {
  margin: 0;
  background-color: #0a192f; /* Apply base background to body */
  color: #e6f1ff;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

/* --- CSS Variables --- */
:root {
  --background-primary: #0a192f;
  --background-secondary: #112240;
  --background-tertiary: #1f2d4a;
  --text-primary: #e6f1ff;
  --text-secondary: #ccd6f6;
  --text-muted: #8892b0;
  --accent-primary: #64ffda; /* Use this for ref row background */
  --accent-primary-dark: #0a7c72;
  --accent-primary-hover: #52d8c3; /* Use this for ref row hover */
  --border-color: #233554;
  --border-color-light: #304a7c;
  --error-color: #ff7b7b;
  --error-background: rgba(255, 123, 123, 0.1);
  --info-color: #77a5ff;
  --warning-color: #ffcc66;
  --border-radius: 6px;
  --card-shadow: 0 8px 25px -8px rgba(2, 12, 27, 0.6);
  --transition-speed: 0.25s;
}


/* --- Layout Containers --- */
.page-wrapper {
  width: 100%;
  padding: 1rem;
  box-sizing: border-box;
}

.genotype-search-container {
  padding-top: 2rem;
  max-width: 1400px;
  margin: 1rem auto;
  display: flex;
  flex-direction: column;
  gap: 2rem;
}

.search-card,
.results-card {
  background-color: #112240;
  border-radius: 8px;
  box-shadow: 0 5px 15px rgba(2, 12, 27, 0.7);
  padding: 1.5rem 2rem;
  border: 1px solid #1d3d6e;
}

/* --- Typography --- */
h2 {
  color: #64ffda;
  font-size: 1.8rem;
  margin-top: 0;
  margin-bottom: 1.5rem;
  border-bottom: 1px solid #1d3d6e;
  padding-bottom: 0.8rem;
}

h3 {
  font-size: 1.3rem;
  margin-top: 0;
  margin-bottom: 1rem;
  color: #a8b2d1;
}

label {
  font-size: 0.9rem;
  color: #ccd6f6;
  margin-bottom: 0.3rem;
  display: block;
}

/* --- Form Styling --- */
.genotype-form {
  display: flex;
  flex-direction: column;
  gap: 2rem;
}

.form-section {
  padding: 1rem;
  border: 1px dashed #1d3d6e;
  border-radius: 6px;
  background-color: #0e1f3a;
}

.form-row {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1.5rem;
    margin-bottom: 1rem;
}

.form-group {
  display: flex;
  flex-direction: column;
}

.form-group select,
.form-group input[type="text"],
.form-group input[type="number"] {
  width: 100%;
  padding: 0.75rem 1rem;
  border: 1px solid #304a7c;
  border-radius: 4px;
  background-color: #0a192f;
  color: #e6f1ff;
  font-size: 0.95rem;
  box-sizing: border-box;
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.form-group select:focus,
.form-group input:focus {
  outline: none;
  border-color: #64ffda;
  box-shadow: 0 0 0 2px rgba(100, 255, 218, 0.3);
}

.form-group input::placeholder {
    color: #8892b0;
    opacity: 0.7;
}

.required-indicator {
  color: var(--error-color);
  margin-left: 4px;
  font-weight: bold;
  cursor: help;
}

.region-inputs {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    align-items: end;
}
.region-inputs label {
    grid-column: 1 / -1;
    margin-bottom: 0.3rem;
}

.range-display .form-group {
    margin-top: -1rem;
    min-height: 20px;
}
.range-info {
  display: block;
  font-size: 0.8rem;
  font-style: italic;
  color: var(--text-muted);
  margin-top: 0.25rem;
  padding-left: 5px;
}
.range-info.loading { color: var(--info-color); }
.range-info.error { color: var(--warning-color); font-style: normal; }

/* --- Action Buttons --- */
.form-actions {
  display: flex;
  justify-content: flex-end;
  gap: 1rem;
  margin-top: 1rem;
  padding-top: 1.5rem;
  border-top: 1px solid #1d3d6e;
}

.primary-btn,
.secondary-btn {
  padding: 0.7rem 1.5rem;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-size: 0.95rem;
  font-weight: 600;
  transition: all 0.2s ease-in-out;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
}

.primary-btn {
  background-color: #64ffda;
  color: #0a192f;
  border: 1px solid #64ffda;
}
.primary-btn:hover:not(:disabled) {
  background-color: #52d8c3;
  border-color: #52d8c3;
  box-shadow: 0 2px 8px rgba(100, 255, 218, 0.3);
}
.primary-btn:disabled {
  background-color: #2a4778;
  color: #8892b0;
  cursor: not-allowed;
  border-color: #2a4778;
  opacity: 0.7;
}
.secondary-btn {
  background-color: transparent;
  color: #ccd6f6;
  border: 1px solid #495a7c;
}
.secondary-btn:hover {
  background-color: rgba(73, 90, 124, 0.2);
  border-color: #64ffda;
  color: #64ffda;
}

/* --- Results Table Styling --- */
.results-card h3 {
    border-bottom: 1px solid #1d3d6e;
    padding-bottom: 0.8rem;
    margin-bottom: 1.5rem;
}

/* 1. Container for Horizontal Scrolling */
.results-table-container {
  width: 100%;
  overflow-x: auto; /* Enable horizontal scroll */
  margin-top: 1rem;
  -webkit-overflow-scrolling: touch;
}

/* 2. Basic Table Setup */
.results-table {
  width: 100%;
  border-collapse: separate; /* Use separate for better sticky border handling */
  border-spacing: 0;
  font-size: 0.9rem;
}

/* 3. Cell Styling */
.results-table th,
.results-table td {
  padding: 0.8rem 1rem;
  text-align: left;
  border-bottom: 1px solid #1d3d6e;
  vertical-align: middle;
  border-right: 1px solid #1d3d6e;
}
.results-table th:last-child,
.results-table td:last-child {
  border-right: none;
}

/* 4. Sticky Header Row */
.results-table thead th {
  background-color: #182a4a;
  color: #ccd6f6;
  font-weight: 600;
  position: sticky;
  top: 0;
  z-index: 3;
  border-bottom-width: 1px; /* Thinner */
  border-bottom-color: var(--border-color-light); /* Match other borders */
  white-space: nowrap; /* Keep header nowrap */
}

/* --- Background Color Management for Rows & Stickies --- */

/* Base background for non-sticky cells in VARIETY rows */
.results-table tbody tr:not(.reference-genome-row) {
   /* background-color: var(--background-secondary); /* Assuming default */
}
.results-table tbody tr:nth-child(even):not(.reference-genome-row) {
   background-color: #182a4a; /* Even row striping */
}

/* Base background for non-sticky cells in REFERENCE row */
.results-table tbody tr.reference-genome-row {
  background-color: var(--accent-primary); /* The bright background */
  font-weight: 500;
  color: var(--background-primary); /* Dark text */
}
/* Override striping for reference row */
.results-table tbody tr.reference-genome-row:nth-child(even) {
    background-color: var(--accent-primary);
}

/* Base background for STICKY cells in VARIETY rows */
.results-table tbody td:nth-child(-n+6) {
  background-color: var(--background-secondary); /* Default sticky bg */
}
/* Override base for even VARIETY rows */
.results-table tbody tr:nth-child(even):not(.reference-genome-row) td:nth-child(-n+6) {
   background-color: #182a4a; /* Match even row striping */
}

/* Base background for STICKY cells in REFERENCE row */
/* --- THIS IS THE KEY CORRECTION --- */
/* Make sticky cells in reference row use the SAME background as the rest of the row */
.results-table tbody tr.reference-genome-row td:nth-child(-n+6) {
   background-color: var(--accent-primary); /* Explicitly match row background */
}


/* --- Hover States --- */

/* Hover for regular VARIETY rows (whole row) */
.results-table tbody tr:not(.reference-genome-row):hover {
  background-color: rgba(100, 255, 218, 0.05);
  color: #fff;
}
/* Apply variety hover ALSO to sticky cells */
.results-table tbody tr:not(.reference-genome-row):hover td:nth-child(-n+6) {
   background-color: rgba(100, 255, 218, 0.05); /* Match row hover */
}

/* Hover for REFERENCE row (whole row) */
.results-table tbody tr.reference-genome-row:hover {
   background-color: var(--accent-primary-hover); /* Darker accent hover */
   color: var(--background-primary);
}
/* Apply reference hover ALSO to sticky cells */
.results-table tbody tr.reference-genome-row:hover td:nth-child(-n+6) {
   background-color: var(--accent-primary-hover); /* Match row hover */
}
/* --- END Background/Hover Logic --- */


/* --- STICKY FIRST 6 COLUMNS (Widths & Left Offsets) --- */
/* !! ADJUST THESE WIDTHS AND RECALCULATED LEFT VALUES !! */

/* General sticky cell settings */
.results-table thead th:nth-child(-n+6),
.results-table tbody td:nth-child(-n+6) {
  position: sticky;
  z-index: 1; /* Base z-index for sticky body cells */
}
.results-table thead th:nth-child(-n+6) {
  z-index: 4; /* Sticky headers above sticky body cells */
}

/* Col 1: Variety/Ref Name (WITH WRAPPING) */
.results-table th:nth-child(1),
.results-table td:nth-child(1) {
  width: 200px; min-width: 200px; max-width: 200px;
  left: 0; z-index: 2; border-right: 1px solid var(--border-color-light);
  white-space: normal; overflow-wrap: break-word; /* Enable wrapping */
}
.results-table thead th:nth-child(1) { z-index: 5; }

/* Col 2: Assay */
.results-table th:nth-child(2), .results-table td:nth-child(2) { width: 100px; min-width: 100px; left: 200px; z-index: 2; border-right: 1px solid var(--border-color-light); }
.results-table thead th:nth-child(2) { z-index: 5; }

/* Col 3: Accession */
.results-table th:nth-child(3), .results-table td:nth-child(3) { width: 110px; min-width: 110px; left: 300px; z-index: 2; border-right: 1px solid var(--border-color-light); }
.results-table thead th:nth-child(3) { z-index: 5; }

/* Col 4: Subpop */
.results-table th:nth-child(4), .results-table td:nth-child(4) { width: 70px; min-width: 70px; left: 410px; z-index: 2; border-right: 1px solid var(--border-color-light); }
.results-table thead th:nth-child(4) { z-index: 5; }

/* Col 5: Dataset */
.results-table th:nth-child(5), .results-table td:nth-child(5) { width: 60px; min-width: 60px; left: 480px; z-index: 2; border-right: 1px solid var(--border-color-light); }
.results-table thead th:nth-child(5) { z-index: 5; }

/* Col 6: Mismatch */
.results-table th:nth-child(6), .results-table td:nth-child(6) { width: 70px; min-width: 70px; text-align: right; left: 540px; z-index: 2; border-right: 1px solid var(--border-color-light); }
.results-table thead th:nth-child(6) { z-index: 5; text-align: right;}
/* --- End Sticky Columns --- */


/* Style for Mismatched Alleles */
.results-table tbody tr td span.allele-mismatch { color: var(--error-color); font-weight: bold; }
.results-table tbody tr td span { display: inline-block; }

/* --- Loading / Empty States --- */
.loading-indicator, .no-results { text-align: center; padding: 3rem 1rem; color: #a8b2d1; font-size: 1.1rem; display: flex; align-items: center; justify-content: center; gap: 0.8rem; border: 1px dashed #1d3d6e; border-radius: 6px; margin-top: 1rem; background-color: #0e1f3a; }
.spinner { width: 1.2em; height: 1.2em; border: 2px solid currentColor; border-right-color: transparent; border-radius: 50%; display: inline-block; animation: spinner-rotation 0.8s linear infinite; }
@keyframes spinner-rotation { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

/* --- Responsive Design --- */
@media (min-width: 768px) {
    .form-row { grid-template-columns: 1fr 1fr; }
    .region-inputs { gap: 1.5rem; }
    .region-inputs label { grid-column: 1 / -1; }
}
@media (max-width: 767px) {
    /* Mobile table display */
    .results-table thead { display: none; }
    .results-table tr { display: block; margin-bottom: 1rem; border: 1px solid #1d3d6e; border-radius: 4px; padding: 1rem; background-color: #112240 !important; }
    .results-table td { display: block; text-align: right; padding: 0.5rem 0; border-bottom: 1px dotted #1d3d6e; white-space: normal !important; border-right: none !important; }
    .results-table td:last-child { border-bottom: none; }
    .results-table td::before { content: attr(data-label); float: left; font-weight: bold; color: #a8b2d1; margin-right: 1rem; white-space: nowrap; }
    .results-table td[data-label="Position"], .results-table td[data-label="Quality"], .results-table td[data-label="Mismatch"] { text-align: right; }

    /* Remove sticky behavior on mobile */
    .results-table th, .results-table td,
    .results-table thead th:nth-child(-n+6),
    .results-table tbody td:nth-child(-n+6) {
        position: static; left: auto; width: auto !important; min-width: auto;
        background-color: transparent !important; z-index: auto;
    }
    .results-table td { background-color: transparent !important; }
    /* Ensure ref row gets its color back on mobile */
    .results-table tr.reference-genome-row {
        background-color: var(--accent-primary) !important;
        color: var(--background-primary) !important;
    }

    /* Form layout on mobile */
    .form-row, .region-inputs { grid-template-columns: 1fr; }
    .region-inputs label { grid-column: 1 / -1; }
}